<?php

class MYNT_LIB extends MYNT{

	function loadPlugins(){

    $dir = $GLOBALS["config"]["define"]["plugin"];

    if(!is_dir($dir)){
      $this->viewError("Not found directory [ ".$dir." ]");
    }

    if(!preg_match("/\/$/",$dir)){
      $dir .= "/";
    }

    if(!isset($GLOBALS["config"]["plugins"]) || !count($GLOBALS["config"]["plugins"])){
      return;
    }

    for($i=0; $i<count($GLOBALS["config"]["plugins"]); $i++){
      $path = $dir . $GLOBALS["config"]["plugins"][$i] ."/php/lib/";
			// echo $path."<br>".PHP_EOL;
      if(!is_dir($path)){continue;}
      $this->loadModulePHPs($path);
    }

  }

	function viewDesign(){

    if(!isset($GLOBALS["config"]["design"]["target"])){
      $this->viewError("Not setting Design.");
    }

    $design = $GLOBALS["config"]["design"]["target"];

    if(!$design || !is_dir("design/".$design)){
      $this->viewError("Not found Design [ ".$design." ]");
    }

		// Load - HTML
		$htmlFile = "index.html";
		if(isset($_REQUEST["h"]) && is_file("design/".$design."/".$_REQUEST["h"].".html")){
			$htmlFile = $_REQUEST["h"].".html";
		}
    $source = file_get_contents("design/".$design."/".$htmlFile);

		if($source){
			$RepTag = new RepTag;
			echo $RepTag->setSource($source);
		}
		else{
			$this->viewError("Not Source");
		}
  }

	function viewError($msg){
      echo "<h1>".$msg."</h1>";
      exit();
  }
}
